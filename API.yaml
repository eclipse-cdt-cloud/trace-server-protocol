###############################################################################
# Copyright (c) 2018, 2021 Ericsson
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#    http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
###############################################################################
openapi: '3.0.2'
info:
  description: Open source REST API for viewing and analyzing any type of logs or traces. Its goal is to provide models to populate views, graphs, metrics, and more to help extract useful information from traces, in a way that is more user-friendly and informative than huge text dumps.
  version: 0.1.0
  title: Trace Server Protocol
  termsOfService: http://tracecompass.org/
  contact:
    email: tracecompass-dev@eclipse.org
  license:
    name: Apache 2
    url: http://www.apache.org/licenses/
servers:
  - url: 'https://localhost:8080/tsp/api'
tags:
- name: Traces
  description: How to manage physical traces on your server.
- name: Experiments
  description: How to manage experiments on your server, an experiment represent a collection of traces, which can produce output models.
- name: Bookmarks
  description: How to bookmark areas of interest in the trace.
- name: Data Tree
  description: Learn about querying generic data tree models
- name: XY
  description: Learn about querying XY models
- name: TimeGraph
  description: Learn about querying Time Graph models.
- name: Virtual Tables
  description: Learn about querying virtual table models (e.g. Events Table).
- name: Styles
  description: Retrieve styles for different outputs
- name: Annotations
  description: Retrieve annotations for different outputs
- name: Filters
  description: How to filter and query
- name: Features
  description: Discover the features which are available on a given server.
- name: Diagnostic
  description: Refer to the server's status
paths:
  /traces:
    get:
      tags:
      - Traces
      summary: Get the list of physical traces imported on the server.
      operationId: getTraces
      responses:
        200:
          description: Returns a list of traces
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/TraceModel'
    post:
      tags:
      - Traces
      summary: Import a trace
      description: Import a trace to the trace server.
        Return some base information once imported.
      operationId: addTrace
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                URI:
                  description: URI of the trace, not necessary if the trace is uploaded via the endpoint
                  type: string
                name:
                  description: The name of the trace in the server, to override the default name
                  type: string
                typeID:
                  description: The trace type's id, to force the use of a parser / disambiguate the trace type.
                  type: string
              required:
                - URI
      responses:
        200:
          description: The trace has been successfully added to the trace server.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TraceModel'
        404:
          description: "No trace available at path"
        406:
          description: "Not acceptable: cannot read this trace type"
        409:
          description: "Conflict: there was already a trace with this name"
  /traces/{traceUUID}:
    delete:
      tags:
      - Traces
      summary: Remove a trace from the server. By default it does not delete the trace from disk.
      operationId: removeTrace
      parameters:
      - name: traceUUID
        in: path
        description: The unique identifier of the trace in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: deleteTrace
        in: query
        description: Indicate if the trace should be deleted from disk or not (false by default)
        required: false
        schema:
          type: boolean
          default: false
      - name: removeCache
        in: query
        description: Indicate if the cache or supplementary files should be removed (false by default).
          If deleteTrace=true, this parameter will also be true.
        required: false
        schema:
          type: boolean
          default: false
      responses:
        200:
          description: The trace was successfully deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TraceModel'
        204:
          description: There was no trace with this name to close / delete
  /experiments:
    get:
      tags:
      - Experiments
      summary: Get the list of experiments on the server
      operationId: getExperiments
      responses:
        200:
          description: Returns a list of experiments
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Experiment'
    post:
      summary: Create a new experiment on the server
      operationId: postExperiment
      tags:
      - Experiments
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  description: The name to give this experiment
                  type: string
                traces:
                  description: The unique identifiers of the traces to encapsulate in this experiment
                  type: array
                  items:
                    type: string
                    format: uuid
              required:
                - name
                - traces
      responses:
        200:
          description: The Experiment was successfully created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Experiment'
  /experiments/{expUUID}:
    get:
      summary: Get the Model object for an experiment
      operationId: getExperiment
      tags:
      - Experiments
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to modify
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: Return the experiment model
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Experiment'
        400:
          description: No such experiment
    put:
      summary: Update an experiment's content and name.
      operationId: putExperiment
      tags:
      - Experiments
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to modify
        required: true
        schema:
          type: string
          format: uuid
      - name: name
        in: query
        description: The name to give this experiment
        required: true
        schema:
          type: string
      requestBody:
        description: Additional information to update an experiment
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                expTypeID:
                  description: Type ID to apply to this experiment
                  type: string
                traces:
                  description: Traces to modify in this experiment
                  type: array
                  items:
                    type: object
                    properties:
                      traceUUID:
                        description: The unique identifier of the trace
                        type: string
                        format: uuid
                      timeOffset:
                        description: Time offset to apply to this trace
                        type: integer
                        format: int64
                      action:
                        description: Action to perform on the given trace (add or remove from the experiment)
                        type: string
                        enum: [add, remove]
                        default: add
                    required:
                      - traceUUID
                      - action
      responses:
        200:
          description: The Experiment was successfully modified
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Experiment'
    delete:
      tags:
      - Experiments
      summary: Remove an Experiment from the server.
      operationId: deleteExperiment
      parameters:
      - name: expUUID
        in: path
        description: The unique identifier of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: The trace was successfully deleted, return the deleted experiment.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Experiment'
        204:
          description: There was no experiment with this name to close / delete
  /experiments/{expUUID}/outputs:
    get:
      tags:
      - Experiments
      summary: Get the list of outputs for this experiment
      operationId: getOutputs
      parameters:
      - name: expUUID
        in: path
        description: The unique identifier of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: Returns a list of output provider descriptors
          content:
            application/json:
              schema:
                type: object
                properties:
                  experiment:
                    $ref: '#/components/schemas/Experiment'
                  providers:
                    type: array
                    items:
                      $ref: '#/components/schemas/OutputDescriptor'
        404:
          description: No such trace
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/{outputID}:
    get:
      tags:
      - Experiments
      summary: Get the output descriptor for this experiment and output
      operationId: getOutput
      parameters:
      - name: expUUID
        in: path
        description: The unique identifier of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: The name of the output provider to query
        required: true
        schema:
          type: string
      responses:
        200:
          description: Returns the output provider descriptor
          content:
            application/json:
              schema:
                type: object
                properties:
                  experiment:
                    $ref: '#/components/schemas/Experiment'
                  providers:
                    type: object
                    items:
                      $ref: '#/components/schemas/OutputDescriptor'
        404:
          description: No such experiment or output
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/bookmarks:
    get:
      summary: Get the collection of bookmarks for an experiment.
      operationId: getExperimentBookmarks
      tags:
      - Bookmarks
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: Returns a list of bookmarks for this trace
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Bookmark'
        404:
          description: No such experiment
          content:
            application/json:
              schema:
                type: string
    post:
      summary: Add a bookmark to an experiment.
      operationId: postExperimentBookmark
      tags:
      - Bookmarks
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      requestBody:
        description: The bookmark to post
        required: true
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/Bookmark'         
      responses:
        200:
          description: Returns the boomark's Id
          content:
            application/json:
              schema:
                type: integer
        404:
          description: No such trace
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/bookmarks/{bookmarkId}:
    get:
      summary: Get a specific bookmark from this experiment
      operationId: getExperimentBookmark
      tags:
      - Bookmarks
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: bookmarkId
        in: path
        description: The unique identifier of the bookmark to get
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: Returns the queried bookmark
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bookmark'
        404:
          description: No such experiment / No such bookmark
          content:
            application/json:
              schema:
                type: string
    put:
      summary: Modify a bookmark
      operationId: putExperimentBookmark
      tags:
      - Bookmarks
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: bookmarkId
        in: path
        description: The unique identifier of the bookmark to modify
        required: true
        schema:
          type: string
      requestBody:
        description: The bookmark to update
        required: true
        content:
          application/json:
            schema:
                $ref: '#/components/schemas/Bookmark' 
      responses:
        200:
          description: Returns the boomark's Id
          content:
            application/json:
              schema:
                type: integer
        404:
          description: No such trace
          content:
            application/json:
              schema:
                type: string
    delete:
      summary: Delete a bookmark
      operationId: deleteExperimentBookmark
      tags:
      - Bookmarks
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: bookmarkId
        in: path
        description: The unique identifier of the bookmark to delete
        required: true
        schema:
          type: string
          format: uuid
      responses:
        200:
          description: Returns the deleted boomark
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Bookmark'
        404:
          description: No such trace or bookmark
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/data/{outputID}/tree:
    post:
      tags:
      - Data Tree
      summary: API to get a data tree.
      description: Unique entry point for output providers,
        to get the tree of visible entries
      operationId: getDataTreeEntry
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the data tree.
          When 'requested_times' is absent the tree for the full range is returned. When present it specifies a range as [start, end].
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111111111, 222222222]
      responses:
        200:
          description: Returns a list of data tree entries. The returned model must be consistent, parentIds must refer to a parent which exists in the model.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        $ref: '#/components/schemas/EntryModel'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/XY/{outputID}/tree:
    post:
      tags:
      - XY
      summary: API to get the XY tree.
      description: Unique entry point for output providers,
        to get the tree of visible entries
      operationId: getXYEntry
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the XY tree.
          When 'requested_times' is absent the tree for the full range is returned. When present it specifies a range as [start, end].
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111111111, 222222222]
      responses:
        200:
          description: Returns a list of XY entries. The returned model must be consistent, parentIds must refer to a parent which exists in the model.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        $ref: '#/components/schemas/EntryModel'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/XY/{outputID}/xy:
    post:
      tags:
      - XY
      summary: API to get the XY model.
      description: Unique endpoint for all xy models,
        ensures that the same template is followed for all endpoints.
      operationId: getXY
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the XY model.
          The array 'requested_times' is the explicit array of requested sample times.
          The array 'requested_items' is the list of entryId or serieId being requested.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_items:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_times
                    - requested_items
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111200000, 111300000, 111400000, 111500000]
                  requested_items: [1, 2]
      responses:
        200:
          description: Return the queried XYResponse
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        $ref: '#/components/schemas/XYModel'
        404:
          description: Trace not found
          content:
            application/json:
              schema:
                type: string
        405:
          description: Analysis not possible for this trace
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/XY/{outputID}/tooltip:
    get:
      tags:
      - XY
      summary: API to get the XY tooltips.
      description: Endpoint to retrieve tooltips for XY
      operationId: getXYTooltip
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      - name: xValue
        in: query
        description: The xValue for which to get the tooltip
        required: true
        schema:
          type: integer
      - name: yValue
        in: query
        description: The yValue for which to get the tooltip
        schema:
          type: number
      - name: entryId
        in: query
        description: The entryId or serieId for which to get the tooltip
        schema:
          type: integer
      responses:
        200:
          description: Returns a list of tooltip keys to values
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    key:
                      type: string
                    value:
                      type: string
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/timeGraph/{outputID}/tree:
    post:
      tags:
      - TimeGraph
      summary: API to get the Time Graph tree.
      description: Unique entry point for output providers,
        to get the tree of visible entries
      operationId: getTimeGraphEntry
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the timegraph tree.
          When 'requested_times' is absent the tree for the full range is returned. When present it specifies a range as [start, end].
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111111111, 222222222]
      responses:
        200:
          description: Returns a list Time graph entries. The returned model must be consistent, parentIds must refer to a parent which exists in the model.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        allOf:
                          - $ref: '#/components/schemas/EntryModel'
                          - type: object
                            properties:
                              entries:
                                type: array
                                items:
                                  $ref: '#/components/schemas/TimeGraphEntry'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/timeGraph/{outputID}/states:
    post:
      tags:
      - TimeGraph
      summary: API to get the Time Graph states
      operationId: getTimeGraphStates
      description: Unique entry point for all TimeGraph states,
        ensures that the same template is followed for all views
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiement to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the timegraph states.
          The array 'requested_times' is the explicit array of requested sample times.
          The array 'requested_items' is the list of entryId being requested.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_items:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_times
                    - requested_items
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111200000, 111300000, 111400000, 111500000]
                  requested_items: [1, 2]
      responses:
        200:
          description: Returns a list of time graph row
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        $ref: '#/components/schemas/TimeGraphModel'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/timeGraph/{outputID}/arrows:
    post:
      tags:
      - TimeGraph
      summary: API to get the Time Graph arrows
      operationId: getTimeGraphArrows
      description: Unique entry point for all TimeGraph models,
        ensures that the same template is followed for all models
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the timegraph arrows.
          The array 'requested_times' is the explicit array of requested sample times.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_times
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111200000, 111300000, 111400000, 111500000]
      responses:
        200:
          description: Returns a sampled list of TimeGraph arrows
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        type: array
                        items:
                          $ref: '#/components/schemas/TimeGraphArrow'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/timeGraph/{outputID}/tooltip:
    post:
      tags:
      - TimeGraph
      summary: API to get a Time Graph tooltip.
      description: Endpoint to retrieve tooltips for time graph
      operationId: getTimeGraphTooltip
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the timegraph tooltip.
          The array 'requested_times' is an array with a single timestamp.
          The array 'requested_items' is an array with a single entryId being requested.
          The object 'requested_element' is the element for which the tooltip is requested.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_items:
                      type: array
                      items:
                        type: integer
                    requested_element:
                      $ref: '#/components/schemas/Element'
                  required:
                    - requested_times
                    - requested_items
                    - requested_element
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111200000]
                  requested_items: [1]
                  requested_element: {elementType: state, time: 111100000, duration: 100000}
      responses:
        200:
          description: Returns a list of tooltip keys to values
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    key:
                      type: string
                    value:
                      type: string
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/timeGraph/{outputID}/navigate/states:
    post:
      tags:
      - TimeGraph
      summary: Tentative API for TimeGraph navigation
      operationId: navigateStates
      description: Endpoint to retrieve the next / previous corresponding states
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      - name: direction
        in: query
        description: Direction of the navigation
        required: true
        schema:
          type: string
          enum: [next, previous]
      requestBody:
        description: Query parameters to fetch the next / previous timegraph state.
          The 'requested_times' array contains the currently selected time.
          The 'requested_times' array contains the currently selected entryId.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_items:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_times
                    - requested_items
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111111111]
                  requested_items: [1]
      responses:
        200:
          description: Returns a list of time graph row
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      desiredTime:
                        type: integer
                        format: int64
                      desiredEntry:
                        type: integer
                        format: int64
                      model:
                        type: array
                        items:
                          $ref: '#/components/schemas/TimeGraphModel'
  /experiments/{expUUID}/outputs/table/{outputID}/columns:
    post:
      tags:
      - Virtual Tables
      summary: API to get table columns.
      description: Unique entry point for output providers, to get the column entries.
      operationId: getEventsTableEntry
      parameters:
      - name: expUUID
        in: path
        description: UUID of the experiment to query
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: ID of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the table columns.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  {}
      responses:
        200:
          description: Returns a list of table headers.
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                type: object
                properties:
                  model:
                    type: array
                    items:
                      $ref: '#/components/schemas/ColumnHeaderEntry'
        404:
          description: Experiment or output provider not found
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/table/{outputID}/lines:
    post:
      tags:
      - Virtual Tables
      summary: API to get virtual table lines
      operationId: getLines
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: The name of the table provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the table lines.
          One of 'requested_table_index' or 'requested_times' should be present. If 'requested_table_index' is used it is the starting index of the lines to be returned. If 'requested_times' is used it should contain an array with a single timestamp and the returned lines starting at the given timestamp (or the nearest following) will be returned.
          The 'requested_table_count' is the number of lines that should be returned.
          When 'requested_table_column_ids' is absent all columns are returned. When present it is the array of requested columnIds.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_table_index:
                      type: integer
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_table_count:
                      type: integer
                    requested_table_column_ids:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_table_count
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_table_index: 0
                  requested_table_count: 100
                  requested_table_column_ids: [0, 1, 2]
      responses:
        200:
          description: Returns a table model with a 2D array of strings and metadata
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/GenericResponse'
                  - type: object
                    properties:
                      model:
                        $ref: '#/components/schemas/TableModel'
        400:
          description: Bad request, the top index and size must be larger than 0
          content:
            application/json:
              schema:
                type: string
        404:
          description: No such Experiment
          content:
            application/json:
              schema:
                type: string
        500:
          description: Error reading the Experiment
          content:
            application/json:
              schema:
                type: string
  /experiments/{expUUID}/outputs/{outputID}/style:
    post:
      tags:
      - Styles
      summary: API to get the style map associated to this experiment and output
      operationId: getStyles
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: The name of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the style map.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  {}
      responses:
        200:
          description: Style model that can be used jointly with OutputElementStyle to retrieve specific style values
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/OutputStyleModel'
  /experiments/{expUUID}/outputs/{outputID}/annotations:
    get:
      tags:
      - Annotations
      summary: API to get annotation categories associated to this experiment and output
      operationId: getAnnotationCategories
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: The name of the output provider to query
        required: true
        schema:
          type: string
      responses:
        200:
          description: Annotation categories model
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnnotationCategoriesModel'
    post:
      tags:
      - Annotations
      summary: API to get the annotations associated to this experiment and output
      operationId: getAnnotations
      parameters:
      - name: expUUID
        in: path
        description: The UUID of the experiment in the server
        required: true
        schema:
          type: string
          format: uuid
      - name: outputID
        in: path
        description: The name of the output provider to query
        required: true
        schema:
          type: string
      requestBody:
        description: Query parameters to fetch the annotations.
          The array 'requested_times' is the explicit array of requested sample times.
          The array 'requested_items' is the list of entryId being requested.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                parameters:
                  type: object
                  properties:
                    requested_times:
                      type: array
                      items:
                        type: integer
                    requested_items:
                      type: array
                      items:
                        type: integer
                  required:
                    - requested_times
                  additionalProperties:
                    type: object
              required:
                - parameters
              example:
                parameters:
                  requested_times: [111200000, 111300000, 111400000, 111500000]
                  requested_items: [1, 2]
      responses:
        200:
          description: Annotation model
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AnnotationModel'
  /filters:
    get:
      summary: Get the list of filters available.
      operationId: getFilters
      tags:
      - Filters
      responses:
        200:
          description: List of filters available.
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Filter'
    post:
      summary: Create a new filter.
      operationId: addFilter
      tags:
      - Filters
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  description: Human readable label for this filter
                  type: string
                start:
                  description: start time for this filter
                  type: integer
                  format: int64
                end:
                  description: end time for this filter
                  type: integer
                  format: int64
                filterExpression:
                  description: expression from the filter language
                  type: string
                tags:
                  description: Desired tags to apply when an elements pass the filter
                  type: integer
                  format: int32
              required:
                - start
                - end
                - filterExpression
      responses:
        200:
          description: Created filter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Filter'
  /filters/{filterID}:
    get:
      summary: Get the filter with the given ID.
      operationId: getFilter
      tags:
      - Filters
      parameters:
      - name: filterID
        description: Filter ID
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        200:
          description: The filter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Filter'
    put:
      summary: Update the given filter.
      operationId: updateFilter
      tags:
      - Filters
      parameters:
      - name: filterID
        description: Filter ID
        in: path
        required: true
        schema:
          type: integer
          format: int32
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  description: Human readable label for this filter
                  type: string
                start:
                  description: start time for this filter
                  type: integer
                  format: int64
                end:
                  description: end time for this filter
                  type: integer
                  format: int64
                filterExpression:
                  description: expression from the filter language
                  type: string
                tags:
                  description: Desired tags to apply when an elements pass the filter
                  type: integer
                  format: int32
      responses:
        200:
          description: The filter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Filter'
    delete:
      summary: Delete the given filter
      operationId: deleteFilter
      tags:
      - Filters
      parameters:
      - name: filterID
        description: Filter ID
        in: path
        required: true
        schema:
          type: integer
          format: int32
      responses:
        200:
          description: The deleted filter
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Filter'
        204:
          description: There was no filter with this ID to delete
  /symbols/{hostID}/{PID}:
    post:
      tags:
      - Symbols
      summary: Import/Upload a symbol provider.
      operationId: addSymbolProvider
      parameters:
      - name: hostID
        in: path
        description: Host ID for the symbol provider
        required: true
        schema:
          type: string
      - name: PID
        in: path
        description: PID for the symbol provider
        required: true
        schema:
          type: string
      requestBody:
        description: URL to the symbol provider, not required if the symbol provider is uploaded directly to the endpoint.
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  description: URL to the symbol provider, not required if the symbol provider is uploaded directly to the endpoint.
                  type: string
      responses:
        200:
          description: The symbol provider has been successfully added to the trace server.
        406:
          description: "Not acceptable: cannot read this symbol provider type"
    get:
      tags:
      - Symbols
      summary: Gets the symbol providers
      operationId: getSymbols
      parameters:
      - name: hostID
        in: path
        description: The host's ID
        required: true
        schema:
          type: string
      - name: PID
        in: path
        description: Process ID
        required: true
        schema:
          type: string
      responses:
        200:
          description: Returns the Symbol providers for this query.
        404:
          description: No such Host, Thread and address combination.
  /about/traceTypes:
    get:
      summary: Get the list of trace types supported by this server.
      operationId: getTraceTypes
      tags:
      - Features
      responses:
        200:
          description: List of the trace types supported by this server.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    ID:
                      description: The unique identifier for this trace type
                      type: string
                    description:
                      description: Human readable description of this trace type
                      type: string
                    versions:
                      description: List supported versions
                      type: array
                      items:
                        type: string
  /about/outputTypes:
    get:
      summary: Get the list of outputs supported by this server.
      tags:
      - Features
      responses:
        200:
          description: List of the output types supported by this server.
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    ID:
                      description: The unique identifier for this output provider type
                      type: string
                    description:
                      description: Human readable description of this output type
                      type: string
                    versions:
                      description: List supported versions
                      type: array
                      items:
                        type: string
  /health:
    get:
      summary: Get the health status of this server
      tags:
      - Diagnostic
      responses:
        200:
          description: The trace server is running and ready to receive requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    description: The status of the server
                    type: string
                    enum:
                    - "UP"
        503:
          description: The trace server is unavailable or in maintenance and cannot receive requests
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    description: The status of the server
                    type: string
                    enum:
                    - "DOWN"
components:
  schemas:
    TraceModel:
      type: object
      properties:
        name:
          description: User defined name for the trace
          type: string
        UUID:
          description: The trace's unique identifier
          type: string
          format: uuid
        path:
          description: Path to the trace on the file server's File System
          type: string
        nbEvents:
          description: Current number of indexed events in the trace.
          type: integer
          format: int64
        start:
          description: The trace's start time
          type: integer
          format: int64
        end:
          description: The trace's end time
          type: integer
          format: int64
        indexingStatus:
          description: Status of the trace indexing
          type: string
          enum:
            - RUNNING
            - COMPLETED
            - CLOSED
    Experiment:
      type: object
      properties:
        name:
          description: User defined name for the experiment
          type: string
        UUID:
          description: The experiment's unique identifier
          type: string
          format: uuid
        nbEvents:
          description: Current number of indexed events in the experiment.
          type: integer
          format: int64
        start:
          description: The experiment's start time
          type: integer
          format: int64
        end:
          description: The experiment's end time
          type: integer
          format: int64
        indexingStatus:
          description: Status of the experiment indexing
          type: string
          enum:
            - RUNNING
            - COMPLETED
            - CLOSED
        traces:
          description: The traces encapsulated by this experiment
          type: array
          items:
            $ref: '#/components/schemas/TraceModel'
    Bookmark:
      type: object
      properties:
        start:
          description: the start time for this bookmark.
          type: integer
          format: int64
        end:
          description: the end time for this bookmark.
          type: integer
          format: int64
        name:
          description: this bookmark's name
          type: string
        type:
          description: The type of the bookmark (generic, output, ...)
          type: string
        iconUrl:
          description: URL to the bookmark's icon
          type: string
        UUID:
          description: The bookmark's unique ID, generated by the server.
          type: string
          format: uuid
    OutputDescriptor:
      type: object
      properties:
        id:
          description: The output provider's ID
          type: string
        name:
          description: The human readable name
          type: string
        description:
          description: Describe the output provider's features
          type: string
        outputType:
          description: Type of data returned by this output. Serve as a hint to determine what kind of view should be use for this output (ex. XY, Time Graph, Table, etc..). Providers of type TREE_TIME_XY and TIME_GRAPH can be grouped under the same time axis. Providers of type DATA_TREE only provide a tree with columns and don't have any XY nor time graph data associated with.
          type: string
          enum:
            - TABLE
            - TREE_TIME_XY
            - TIME_GRAPH
            - DATA_TREE
        queryParameters:
          description: List all the possible paramaters that can be use to query this output.
          type: object
          additionalProperties:
            type: object
        start:
          description: The start time of the output model
          type: integer
          format: int64
        end:
          description: The end time of the output model
          type: integer
          format: int64
        final:
          description: If the start, end times and current model are final, or if they will need to be refreshed later to represent a more up to date version.
          type: boolean
        compatibleProviders:
          description: List of IDs of compatible outputs that can be used in the same view (ex. as overlay)
          type: array
          items:
            type: string
    TableModel:
      type: object
      properties:
        lowIndex:
          description: Index in the virtual table of the first returned event
          type: integer
          format: int64
        size:
          description: Number of events. If filtered, the size will be the number of events that match the filters
          type: integer
          format: int32
        columnIds:
          description: The array of column ids that are returned. They should match the content of the lines' content.
          type: array
          items:
            type: integer
            format: int64
        lines:
          type: array
          items:
            $ref: '#/components/schemas/LineModel'
    LineModel:
      type: object
      properties:
        index:
          description: The index of this line in the virtual table
          type: integer
          format: int64
        cells:
          description: The content of the cells for this line. This array matches the column ids returned above.
          type: array
          items:
            type: object
            properties:
              content:
                description: Content of the cell for this line. The content uses markdown to format the text
                type: string
              tags:
                description: Specific tags for this cell
                type: integer
                format: int32
        tags:
          description: Tags for the entire line
          type: integer
          format: int32
    ColumnHeaderEntry:
      type: object
      properties:
        id:
          description: Unique id to identify this column in the backend.
          type: integer
          format: int32
        name:
          description: Displayed name for this column
          type: string
        description:
          description: Description of the column
          type: string
        type:
          description: Type of data associated to this column
          type: string
    EntryHeader:
      type: object
      properties:
        name:
          description: Displayed name for this header
          type: string
        tooltip:
          description: Displayed tooltip for this header. Optional, no tooltip is applied if absent.
          type: string
      required:
        - name
    XYModel:
      type: object
      properties:
        title:
          description: Title of the model
          type: string
        commonXAxis:
          description: Indicate if the model use a common X axis
          type: boolean
        series:
          type: array
          items:
            $ref: '#/components/schemas/XYSeries'
      required:
        - title
        - series
    XYSeries:
      type: object
      properties:
        seriesName:
          description: series' name
          type: string
        seriesId:
          description: series' ID
          type: integer
          format: int64
        xAxis:
          $ref: '#/components/schemas/XYAxis'
        yAxis:
          $ref: '#/components/schemas/XYAxis'
        xValues:
          description: series' X values
          type: array
          items:
            type: integer
            format: int64
        yValues:
          description: series' Y values
          type: array
          items:
            type: number
            format: double
        tags:
          description: Array of tags for each xy values
          type: array
          items:
            type: integer
            format: int32
        style:
          $ref: '#/components/schemas/OutputElementStyle'
      required:
        - seriesName
        - seriesId
        - xValues
        - yValues
    XYAxis:
      type: object
      properties:
        label:
          description: Label to apply to the axis
          type: string
        unit:
          description: The units used for this axis, to be appended to the data
          type: string
        dataType:
          description: Type of data this series represents. Gives a hint on the formatting to give to the data
          type: string
          enum:
            - NUMBER
            - BINARY_NUMBER
            - TIMESTAMP
            - DURATION
            - STRING
    TimeGraphModel:
      type: object
      properties:
        rows:
          type: array
          items:
            $ref: '#/components/schemas/TimeGraphRow'
    TimeGraphEntry:
      allOf:
        - $ref: '#/components/schemas/Entry'
        - type: object
          properties:
            start:
              description: Beginning of the range for which this entry exists
              type: integer
              format: int64
            end:
              description: End of the range for which this entry exists
              type: integer
              format: int64
    TimeGraphState:
      type: object
      properties:
        start:
          description: start time for this state
          type: integer
          format: int64
        end:
          description: end time for this state
          type: integer
          format: int64
        label:
          description: Text label to apply to this TimeGraphState if resolution permits.
            Optional, no label is applied if absent.
          type: string
        tags:
          description: Tags to apply on this state
          type: integer
          format: int32
        style:
          $ref: '#/components/schemas/OutputElementStyle'
      required:
        - start
        - end
    TimeGraphRow:
      type: object
      properties:
        entryId:
          description: The entry to map this state list to
          type: integer
          format: int64
        states:
          description: List of the time graph entry states associated to this entry and zoom level.
          type: array
          items:
            $ref: '#/components/schemas/TimeGraphState'
      required:
        - entryId
        - states
    TimeGraphArrow:
      type: object
      properties:
        start:
          description: start time for this arrow
          type: integer
          format: int64
        end:
          description: end time for this arrow
          type: integer
          format: int64
        sourceId:
          description: Source entry's unique ID
          type: integer
          format: int64
        targetId:
          description: Target entry's unique ID
          type: integer
          format: int64
        style:
          $ref: '#/components/schemas/OutputElementStyle'
      required:
        - start
        - end
        - sourceId
        - targetId
    Filter:
      type: object
      properties:
        id:
          description: Unique id to identify this entry in the backend.
          type: integer
          format: int32
        name:
          description: Human readable label for this filter
          type: string
        start:
          description: start time for this filter
          type: integer
          format: int64
        end:
          description: end time for this filter
          type: integer
          format: int64
        expression:
          description: expression from the filter language
          type: string
        tags:
          description: Tags to be applied on elements that pass this filter
          type: integer
          format: int32
    ResponseStatus:
      description: All possible status for a server response
      type: string
      enum:
        - RUNNING
        - COMPLETED
        - FAILED
        - CANCELLED
    GenericResponse:
      description: Generic response that include an output descriptor, the status and a status message
      type: object
      properties:
        output:
          $ref: '#/components/schemas/OutputDescriptor'
        status:
          $ref: '#/components/schemas/ResponseStatus'
        statusMessage:
          type: string
    Entry:
      description: Base entry returned by tree endpoints
      type: object
      properties:
        labels:
          description: Array of cell labels to be displayed. The length of the array and the index of each column need to correspond to the header array returned in the tree model.
          type: array
          items:
            type: string
        id:
          description: Unique id to identify this entry in the backend
          type: integer
          format: int32
        parentId:
          description: Unique id to identify this parent's entry,
            optional if this entry does not have a parent.
          type: integer
          format: int32
        hasData:
          description: Whether or not this entry has data
          type: boolean
        style:
          $ref: '#/components/schemas/OutputElementStyle'
      required:
        - labels
        - id
    EntryModel:
      type: object
      properties:
        entries:
          type: array
          items:
            $ref: '#/components/schemas/Entry'
        headers:
          type: array
          items:
            $ref: '#/components/schemas/EntryHeader'
      required:
        - entries
    OutputStyleModel:
      type: object
      description: Map of styles specific to an output where values gives hints on the style. The keys are strings that can be used in OutputElementStyle
      properties:
        styles:
          properties:
            styleKey1:
              $ref: '#/components/schemas/OutputElementStyle'
            styleKey2:
              $ref: '#/components/schemas/OutputElementStyle'
    OutputElementStyle:
      type: object
      description: Represents the style on an element (ex. Entry, TimeGraphState, ...) returned by any output. 
        Supports style inheritance. To avoid having too many styles, the element style can have a parent style and will have all the same style property values as the parent and can add or override style properties.
      properties:
        parentKey:
          description: Parent style key or empty if there is no parent. The parent key should match a style key defined in the style model and is used for style inheritance. A comma-delimited list of parent style keys can be used for style composition, the last one taking precedence.
          type: string
        values:
            $ref: '#/components/schemas/StyleProperty'
    StyleProperty:
      type: object
      description: Style values or empty map if there is no values.
      properties:
        background-color:
          description: Background color, specified as an hex string '#rrggbb'. Default is '#000000'.
          type: string
        color:
          description: Foreground color, specified as an hex string '#rrggbb'. Default is '#000000' or, when the element has a background color, a distinct color from this background color.
          type: string
        opacity:
          description: Opacity level of an element between 0.0 and 1.0 where 0.0 is transparent and 1.0 is fully opaque. Default is 1.0.
          type: number
        border-style:
          description: Border style as string. Default is 'none'.
          enum:
            - none
            - dotted
            - dashed
            - solid
            - double
        border-color:
          description: Border color, specified as an hex string '#rrggbb'. Used when 'border-style' is other than 'none'. Default is '#000000'.
          type: string
        border-width:
          description: Border width in pixels. Used when 'border-style' is other than 'none'. Default is 1.
          type: number
        height:
          description: Height of an element, as a factor, between 0.0 and 1.0, of the normal element height. Default is 1.0.
          type: number
        width:
          description: Width of an element in pixels. Not applicable to elements representing a time duration. Default is 1.
          type: number
        symbol-type:
          description: Symbol type as a string. Default is 'none'.
          enum:
            - none
            - diamond
            - circle
            - square
            - triangle
            - inverted-triangle
            - cross
            - plus
        vertical-align:
          description: Vertical alignment as a string. Default is 'middle'.
          enum:
            - middle
            - top
            - bottom
        <colorkey>-blend:
          description: Suffix to be appended to a color style key to apply a blending color to that style's color value. The value of the modifier style is an hex string that includes the blending color's alpha between 0 and 255 '#rrggbbaa'.
          type: string
        <numberkey>-factor:
          description: Suffix to be appended to a numerical style key to apply a multiplication factor to that style's numerical value. The value of the modifier style is a positive number.
          type: number
    Annotation:
      type: object
      description: An annotation is used to mark interesting area at a given time or time range.
      properties:
        time:
          type: integer
          format: int64
          description: time of this annoation
        duration:
          type: integer
          format: int64
          description: duration of this annotation
        entryId:
          type: integer
          format: int64
          description: entry's unique ID or -1 if annotation not associated with an entry
        type:
          type: string
          enum: [TREE, CHART]
          description: type of annotation indicating its location
        label:
          type: string
          description: text label of this annotation
        style:
          $ref: '#/components/schemas/OutputElementStyle'
      required:
        - time
        - duration
        - entryId
        - type
    AnnotationModel:
      type: object
      description: Model returned by outputs that contains annotations per category.
      properties:
        annotations:
          description: Map of annotations where the keys are categories
          additionalProperties:
            type: array
            items:
              $ref: '#/components/schemas/Annotation'
    AnnotationCategoriesModel:
      type: object
      description: Model returned by outputs that contains annotation categories available for this output.
      properties:
        annotationCategories:
          description: Array of all the categories
          type: array
          items:
            type: string
    Element:
      type: object
      description: An element model to be identified.
      properties:
        elementType:
          description: The type of element
          type: string
          enum: [state, annotation, arrow]
        time:
          description: element's start time
          type: integer
          format: int64
        duration:
          description: element's duration
          type: integer
          format: int64
        entryId:
          description: entry's unique ID (annotation, arrow)
          type: integer
          format: int32
        destinationId:
          description: destination entry's unique ID (arrow)
          type: integer
          format: int32
      required:
        - elementType
        - time
        - duration

